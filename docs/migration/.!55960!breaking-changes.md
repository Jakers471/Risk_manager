# Breaking Changes

This document lists all breaking changes introduced in ProjectX Python SDK releases, providing migration paths and timelines for deprecated features.

## v4.0.0 - Major Release (Planned)

**Release Date**: TBD
**Migration Period**: 6 months after release
**Support**: v3.x will receive critical bug fixes for 12 months after v4.0 release

### Statistics System Redesign

**BREAKING**: Complete overhaul of statistics system with async-first architecture.

#### What Changed

**Before (v3.x)**:
```python
# Synchronous statistics methods
stats = suite.get_stats()
health = suite.get_health_scores()
memory = suite.get_memory_stats()
```

**After (v4.0)**:
```python
# All statistics methods are now async
stats = await suite.get_statistics()
health = await suite.get_health_scores()
memory = await suite.get_memory_stats()
```

#### Impact Level: **HIGH**

All code using statistics methods must be updated to use async/await.

#### Migration Path

1. **Immediate**: Update all statistics calls to async
2. **Use migration script**: `python migrate_to_v4.py --fix-stats`
3. **Test thoroughly**: Ensure all async conversions work correctly

#### Timeline

- **v3.1.0**: New async methods introduced alongside sync versions
- **v3.2.0**: Deprecation warnings added to sync methods
- **v3.3.0**: Sync methods marked for removal
- **v4.0.0**: Sync methods removed entirely

### DataFrame Library Changes

**BREAKING**: Pandas support removed, Polars becomes the only supported DataFrame library.

#### What Changed

**Before (v3.x)**:
```python
import pandas as pd
# Could work with either pandas or polars
bars = await client.get_bars("MNQ")
if isinstance(bars, pd.DataFrame):
    bars['sma'] = bars['close'].rolling(20).mean()
```

**After (v4.0)**:
```python
import polars as pl
from project_x_py.indicators import SMA
# Always returns Polars DataFrame
bars = await client.get_bars("MNQ")
sma_values = bars.pipe(SMA, period=20)
```

#### Impact Level: **MEDIUM**

Code using pandas operations must be converted to Polars equivalents.

#### Migration Path

1. **Replace pandas imports** with polars
2. **Convert DataFrame operations** to Polars syntax
3. **Use built-in indicators** instead of manual calculations
4. **Update type annotations** from `pd.DataFrame` to `pl.DataFrame`

### Legacy Mixin Removal

**BREAKING**: Legacy statistics mixins removed.

#### What Changed

**Removed Classes**:
- `EnhancedStatsTrackingMixin` L
- `StatsTrackingMixin` L
- `LegacyStatsManager` L

**Replacement**:
- Use new `BaseStatisticsTracker` and `ComponentCollector` system

#### Impact Level: **LOW**

Only affects code directly using these internal mixins.

## v3.3.0 - Statistics System Overhaul (Released 2025-01-21)

### Async Statistics Implementation

**BREAKING**: Statistics methods changed from synchronous to asynchronous.

#### What Changed

All statistics-related methods now require `await`:

```python
# v3.2.x and earlier
stats = suite.get_stats()                    # L Removed
health = component.get_health_score()       # L Removed
memory = manager.get_memory_stats()         # L Removed

# v3.3.0+
stats = await suite.get_statistics()        #  New async method
health = await component.get_health_score() #  Now async
memory = await manager.get_memory_stats()   #  Now async
```

#### Migration Required

1. Add `await` to all statistics calls
2. Make calling functions async
3. Update tests to use `@pytest.mark.asyncio`

### Legacy Statistics Mixins Deprecated

**DEPRECATED**: Old statistics mixins marked for removal in v4.0.0.

```python
# These are deprecated and will be removed
