# Position Management Guide

This guide covers comprehensive position management and tracking using ProjectX Python SDK v3.3.4+. All position operations are fully asynchronous and provide real-time monitoring capabilities.

## Overview

The PositionManager provides complete position lifecycle management including tracking, risk monitoring, performance analytics, and automated position reconciliation. All operations are designed for high-performance trading applications.

### Key Features

- **Real-time Position Tracking**: Live position updates via WebSocket
- **Performance Analytics**: Comprehensive P&L analysis and metrics
- **Risk Monitoring**: Position-based risk calculations and alerts
- **Portfolio Management**: Multi-instrument portfolio tracking
- **Position Reconciliation**: Automatic position validation and cleanup
- **Event-Driven Updates**: Real-time position change notifications

## Getting Started

### Basic Setup

```python
import asyncio
from decimal import Decimal
from project_x_py import TradingSuite

async def main():
    # Initialize with position management capabilities
    suite = await TradingSuite.create("MNQ")

    # Position manager is automatically available
    position_manager = suite.positions

    # Get current account information
    account = suite.client.account_info
    print(f"Account: {account.name}")
    print(f"Balance: ${account.balance}")
```

## Position Tracking

### Current Position Status

```python
async def check_current_positions():
    suite = await TradingSuite.create("MNQ")

    # Get specific position
    mnq_position = await suite.positions.get_position("MNQ")

    if mnq_position:
        print(f"MNQ Position:")
        print(f"  Size: {mnq_position.size} contracts")
        print(f"  Average Price: ${mnq_position.averagePrice}")
        print(f"  Unrealized P&L: ${mnq_position.unrealizedPnL}")
        print(f"  Market Value: ${mnq_position.marketValue}")
    else:
        print("No MNQ position")

    # Get all positions
    all_positions = await suite.positions.get_all_positions()

    print(f"\nAll positions ({len(all_positions)}):")
    for position in all_positions:
        print(f"  {position.contractId}: {position.size} @ ${position.averagePrice}")

    # Get positions with filters
    long_positions = await suite.positions.get_positions(
        side_filter="long",      # only long positions
        min_size=1               # minimum 1 contract
    )

    short_positions = await suite.positions.get_positions(
        side_filter="short",
        instruments=["MNQ", "MES"]  # specific instruments
    )
```

### Real-time Position Monitoring

```python
from project_x_py import EventType

async def setup_position_monitoring():
    suite = await TradingSuite.create("MNQ")

    # Event-driven position updates
    async def on_position_update(event):
        position_data = event.data

        print(f"Position Update: {position_data['contractId']}")
        print(f"  Size: {position_data['size']}")
        print(f"  P&L: ${position_data['unrealizedPnL']:.2f}")

        # Check for risk alerts
        if abs(position_data.get('unrealizedPnL', 0)) > 500:
