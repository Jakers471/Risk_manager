# Trading Suite API

Unified trading interface combining all managers into a single, easy-to-use entry point for complete trading operations.

## Overview

The TradingSuite is the primary interface for trading operations, combining all managers into a unified interface. It provides automatic component initialization, dependency injection, and configuration management.


## Quick Start

### Basic Setup

```python
from project_x_py import TradingSuite

async def main():
    # Simple one-liner with defaults
    suite = await TradingSuite.create("MNQ")

    # Everything is ready - client authenticated, realtime connected
    await suite.disconnect()

asyncio.run(main())
```

### Advanced Configuration

```python
async def advanced_setup():
    # With specific configuration
    suite = await TradingSuite.create(
        instrument="MNQ",
        timeframes=["1min", "5min", "15min"],
        features=["orderbook", "risk_manager"],
        initial_days=10,
        timezone="America/Chicago"
    )

    # Access integrated components
    print(f"Client: {suite.client}")
    print(f"Orders: {suite.orders}")
    print(f"Positions: {suite.positions}")
    print(f"Data: {suite.data}")
    print(f"OrderBook: {suite.orderbook}")  # if enabled
    print(f"RiskManager: {suite.risk_manager}")  # if enabled

    await suite.disconnect()
```

### Configuration File Setup

```python
async def config_file_setup():
    # From configuration file
    suite = await TradingSuite.from_config("config/trading.yaml")

    # Or from dictionary
    config = {
        "instrument": "MNQ",
        "timeframes": ["1min", "5min"],
        "features": ["orderbook"],
        "initial_days": 5
    }
    suite = await TradingSuite.from_dict(config)

    await suite.disconnect()
```

## Features

### Available Features


### Feature Configuration

```python
from project_x_py import Features

# Enable specific features
features = [
    Features.ORDERBOOK,        # Level 2 market depth
    Features.RISK_MANAGER,     # Risk management and position sizing
    Features.AUTO_RECONNECT,   # Automatic reconnection (future)
]

suite = await TradingSuite.create(
    "MNQ",
    features=features
)
```

## Configuration

### TradingSuiteConfig


### Component Configuration

```python
from project_x_py.types import (
    OrderManagerConfig,
    PositionManagerConfig,
    DataManagerConfig,
    OrderbookConfig
)
from project_x_py.risk_manager import RiskConfig

async def custom_configuration():
    # Custom component configurations
    order_config = OrderManagerConfig(
        max_concurrent_orders=10,
        default_timeout=30.0,
        retry_attempts=3
    )

    position_config = PositionManagerConfig(
        track_unrealized=True,
        calculate_metrics=True,
        update_frequency=1.0
    )

    risk_config = RiskConfig(
        max_position_size=5,
        max_daily_loss=1000.0,
        max_drawdown_percent=10.0
    )

    suite = await TradingSuite.create(
        "MNQ",
        order_manager_config=order_config,
        position_manager_config=position_config,
        risk_config=risk_config
    )

    await suite.disconnect()
```

## Component Access

### Core Components

```python
async def component_access():
    suite = await TradingSuite.create("MNQ", features=["orderbook", "risk_manager"])

    # Always available components
    client = suite.client              # ProjectX API client
    orders = suite.orders             # OrderManager
    positions = suite.positions       # PositionManager
    data = suite.data                 # RealtimeDataManager
    realtime = suite.realtime         # ProjectXRealtimeClient

    # Optional components (based on features)
    if suite.orderbook:
        orderbook = suite.orderbook   # OrderBook (Level 2)

    if suite.risk_manager:
        risk_mgr = suite.risk_manager # RiskManager

    # Instrument information
    instrument_info = suite.instrument_info
    instrument_id = suite.instrument_id

    await suite.disconnect()
```

## Trading Operations

### Order Management

```python
async def order_operations():
    suite = await TradingSuite.create("MNQ")

    # Place market order
    market_order = await suite.orders.place_market_order(
        contract_id=suite.instrument_id,
        side=0,  # Buy
        size=1
    )

    # Place limit order
    limit_order = await suite.orders.place_limit_order(
        contract_id=suite.instrument_id,
        side=0,  # Buy
        size=1,
        limit_price=21050.0
    )

    # Place bracket order
    bracket_result = await suite.orders.place_bracket_order(
        contract_id=suite.instrument_id,
        side=0,  # Buy
        size=1,
        entry_price=21050.0,
        stop_offset=25.0,
        target_offset=50.0
    )

    await suite.disconnect()
```

### Position Management

```python
async def position_operations():
    suite = await TradingSuite.create("MNQ")

    # Get current position
    position = await suite.positions.get_position("MNQ")
    if position:
        print(f"Size: {position.size}")
        print(f"Avg Price: {position.avg_price}")
        print(f"Unrealized PnL: {position.unrealized_pnl}")

    # Get all positions
    all_positions = await suite.positions.get_all_positions()

    # Get position metrics
    metrics = await suite.positions.get_metrics()
    print(f"Total PnL: {metrics.get('total_pnl', 0)}")
    print(f"Win Rate: {metrics.get('win_rate', 0):.1%}")

    await suite.disconnect()
```

### Market Data Access

```python
async def data_access():
    suite = await TradingSuite.create("MNQ", timeframes=["1min", "5min"])

    # Get historical data via client
    historical = await suite.client.get_bars("MNQ", days=5, interval=60)

    # Get real-time data
    current_price = await suite.data.get_current_price()
    latest_bars_1min = await suite.data.get_data("1min")
    latest_bars_5min = await suite.data.get_data("5min")

    # OrderBook data (if enabled)
    if suite.orderbook:
        depth = await suite.orderbook.get_depth()
        trades = await suite.orderbook.get_recent_trades()

    await suite.disconnect()
```

## Event Handling

### Real-time Events

```python
from project_x_py import EventType

async def event_handling():
    suite = await TradingSuite.create("MNQ", timeframes=["1min"])

    # Register event handlers
    async def on_new_bar(event):
        print(f"New {event.timeframe} bar: {event.data}")

    async def on_order_filled(event):
        print(f"Order filled: {event.order_id}")

    async def on_position_changed(event):
        print(f"Position changed: {event.data}")

    # Register handlers
    await suite.on(EventType.NEW_BAR, on_new_bar)
    await suite.on(EventType.ORDER_FILLED, on_order_filled)
    await suite.on(EventType.POSITION_CHANGED, on_position_changed)

    # Keep running to receive events
    await asyncio.sleep(60)
    await suite.disconnect()
```

## Statistics & Health Monitoring

### Comprehensive Statistics

```python
async def statistics_monitoring():
    suite = await TradingSuite.create("MNQ", features=["orderbook", "risk_manager"])

    # Get system statistics (async-first API)
    stats = await suite.get_stats()
    print(f"System Health: {stats['health_score']:.1f}/100")
    print(f"API Success Rate: {stats['api_success_rate']:.1%}")
    print(f"Memory Usage: {stats['memory_usage_mb']:.1f} MB")

    # Component-specific statistics
    order_stats = await suite.orders.get_stats()
    position_stats = await suite.positions.get_stats()
    data_stats = await suite.data.get_stats()

    if suite.orderbook:
        orderbook_stats = await suite.orderbook.get_stats()

    # Export statistics
    prometheus_metrics = await suite.export_stats("prometheus")
    csv_data = await suite.export_stats("csv")

    await suite.disconnect()
```

### Health Monitoring

```python
async def health_monitoring():
    suite = await TradingSuite.create("MNQ")

    # Real-time health monitoring
    health_score = await suite.get_health_score()
    if health_score < 70:
